document.addEventListener("DOMContentLoaded",()=>{let t,e,a=(new Date).toISOString().split("T")[0];const n=document.querySelectorAll(".button-container button");n.forEach(t=>{t.classList.add("hide")}),u("GOOGL","2023-01-01",a,5e3);var r=document.getElementById("myModal"),o=document.getElementById("openModalBtn"),l=document.getElementsByClassName("close")[0];o.onclick=function(){r.style.display="block"},l.onclick=function(){r.style.display="none"},window.onclick=function(t){t.target==r&&(r.style.display="none")};const i=t=>{let e=t.length,a=[],n=0;for(;n<e-1;){for(;n<e-1&&t[n]>=t[n+1];)n++;if(n===e-1)break;let r=n;for(;n<e-1&&t[n]<=t[n+1];)n++;let o=n;a.push({buy:{day:r,price:t[r]},sell:{day:o,price:t[o]}})}return a};let c;const d=(t,e)=>{let a,n=t;c=0;for(let t=0;t<e.length;t++)c=n/e[t].buy.price,n=c*e[t].sell.price;return a=n-t,a};function s(){const t=document.querySelector("#chart-container svg");t&&t.remove()}function u(t,e,a,n){s(),s(),fetch(`https://api.marketstack.com/v1/eod?access_key=a102fb3f246cfc748eabb0cbafd35e2b&symbols=${t}&date_from=${e}&date_to=${a}`).then(t=>t.json()).then(e=>{const a=e.data.map(t=>t.close),r=e.data.map(t=>t.date.slice(0,10)),o=Math.max(...a),l=1.35*o,s=(Math.min(...a),60),u=530,p=400-s-50,m=i(a),y=d3.select("#chart-container").append("svg").attr("width",600).attr("height",p+s+50).append("g").attr("transform","translate(50,"+s+")"),f=(d3.timeParse("%Y-%m-%d"),d3.scaleBand().range([0,u]).padding(.1)),h=d3.scaleLinear().domain([0,l]).nice().range([p,0]),g=(d3.scaleLinear().domain([0,o]).range([p,0]),r.map((t,e)=>({date:t,price:a[e]})).sort((t,e)=>new Date(t.date)-new Date(e.date)));f.domain(g.map(t=>t.date)),h.domain([0,l]),y.append("g").call(d3.axisLeft(h)),y.append("text").attr("transform","rotate(-90)").attr("y",-50).attr("x",0-p/2).attr("dy","1em").style("text-anchor","middle").text("Price ($)"),y.append("g").attr("class","x-axis").attr("transform","translate(0,"+p+")").call(d3.axisBottom(f)).selectAll(".tick text").attr("class","x-axis-label").attr("transform",function(t,e){return f.domain().length>15?0===e||e===f.domain().length-1?"rotate(-45)":"rotate(0)":"rotate(-45)"}).style("text-anchor",function(t,e){return f.domain().length>15?0===e||e===f.domain().length-1?"end":"middle":"end"}).style("fill-opacity",function(t,e){return f.domain().length>15?0===e||e===f.domain().length-1?1:0:1}),y.append("text").attr("x",265).attr("y",0-s/2).attr("text-anchor","middle").style("font-size","18px").style("font-weight","bold").text(t.toUpperCase());const x=d3.line().x(t=>f(t.date)+f.bandwidth()/2).y(t=>h(t.price)).curve(d3.curveBasis);y.append("path").datum(g).attr("class","line").attr("d",x).attr("stroke","steelblue").attr("stroke-width",5).attr("fill","none").attr("stroke-dasharray",function(){const t=this.getTotalLength();return t+" "+t}).attr("stroke-dashoffset",function(){return this.getTotalLength()}).transition().duration(2e3).attr("stroke-dashoffset",0),d3.bisector(t=>t.date).left,y.select(".line").on("mousemove",function(t){const[e,a]=d3.pointer(t),n=Math.floor((e-50)/f.bandwidth()),r=Math.max(0,Math.min(n,g.length-1)),o=g[r],l=d3.select("#tooltip");l.style("left",e+100+"px").style("top",a+150+"px").style("opacity",.8).style("box-shadow","2px 2px 5px rgba(0, 0, 0, 0.5)").html(`Price: $${o.price.toFixed(2)}`),l.transition().duration(200).style("opacity",1)}).on("mouseout",function(t,e){tooltip.node().timeout=setTimeout(()=>{tooltip.transition().duration(200).style("opacity",0)},1e3)});let b=m.reverse();y.selectAll(".buy-circle").data(b).enter().append("circle").attr("class","buy-circle").attr("r",0).attr("cx",t=>f(r[t.buy.day])).attr("cy",t=>h(a[t.buy.day])).style("fill","#359d2f").transition().delay((t,e)=>70*e).duration(1e3).attr("r",2),y.selectAll(".sell-circle").data(b).enter().append("circle").attr("class","sell-circle").attr("r",0).attr("cx",t=>f(r[t.sell.day])).attr("cy",t=>h(a[t.sell.day])).style("fill","red").transition().delay((t,e)=>70*e).duration(1e3).attr("r",2),document.querySelectorAll("svg").forEach(t=>{t.style.height=p+s+50+"px"}),document.getElementById("max-price"),document.getElementById("min-price"),document.getElementById("buy-sell-points"),m.forEach(({buy:t,sell:e})=>{}),document.getElementById("profit"),d(n,m);let v=0,k=[];for(let t=0;t<m.length;t++)v+=m[t].sell.price-m[t].buy.price,k.push(v),k[t]*=c;const E=[];for(let t=0;t<m.length;t++){const e=g[m[t].buy.day].date,a=g[m[t].sell.day].date;E.push(`Buy: ${e}, Sell: ${a}`)}var L=d3.select("#chart-container").append("svg").style("overflow","visible").attr("width",600).attr("height",400).append("g").attr("transform","translate(50,60)"),B=d3.scaleBand().domain(d3.range(k.length)).range([0,u]).padding(.1),w=d3.scaleLinear().domain([0,d3.max(k)]).nice().range([p,0]);L.selectAll(".bar").data(k).enter().append("rect").attr("class","bar").attr("class","bar bar-transition").attr("data-index",function(t,e){return e}).attr("x",function(t,e){return B(e)}).attr("width",B.bandwidth()).attr("y",function(t){return w(t)}).attr("height",function(t){return p-w(t)}).on("mouseover",function(t){const e=d3.select(this).attr("data-index"),a=d3.select("#tooltip");a.transition().duration(200).style("opacity",.8),a.html(`Trade Dates: ${E[e]}`).style("left",t.pageX+"px").style("top",t.pageY-28+"px")}).on("mouseout",function(){d3.select("#tooltip").transition().duration(500).style("opacity",0)}),L.selectAll(".bar-transition").transition().duration(1e3).attr("y",function(t){return w(t)}).attr("height",function(t){return p-w(t)}),L.append("g").attr("class","x-axis").attr("transform","translate(0,"+p+")").call(d3.axisBottom(B).tickSize(0).tickFormat("")),L.append("g").attr("class","y-axis").call(d3.axisLeft(w)).append("text").attr("transform","rotate(-90)").attr("y",-50).attr("x",-145).attr("dy",".5em").style("text-anchor","middle").style("fill","black").style("font-size","16px").text("Accumulated Profit ($)"),L.append("text").attr("x",265).attr("y",0-s/2).attr("text-anchor","middle").style("font-size","18px").style("font-weight","bold").text("Net Accumulated Profit")}).catch(t=>{console.error("Error:",t)})}document.getElementById("apple").addEventListener("click",function(){u("AAPL",t,a,e)}),document.getElementById("microsoft").addEventListener("click",function(){u("MSFT",t,a,e)}),document.getElementById("palantir").addEventListener("click",function(){u("PLTR",t,a,e)}),document.getElementById("tesla").addEventListener("click",function(){u("TSLA",t,a,e)}),document.querySelector(".ticker-submit").addEventListener("click",r=>{r.preventDefault(),n.forEach(t=>{t.classList.remove("hide")});const o=document.querySelector(".ticker-input"),l=document.querySelector(".date-input"),i=document.querySelector(".investment-input");let c=o.value;t=l.value,e=parseFloat(i.value),a=(new Date).toISOString().split("T")[0],u(c,t,a,e)})});
//# sourceMappingURL=main.js.map